## 01a_區塊鏈概述
### 區塊鏈
- 紀錄交易內容
- 紀錄前一個區塊的摘要
- 封裝

舉例：帳本
- 要記錄的內容太多了，沒有無限的空間，且電腦是需要離散的儲存技術
- 區塊鏈把每一天的交易內容切成區塊

### 古代中心化帳本：銀行
只有一本帳本記錄所有的交易內容

缺點
- 高手續費：每個人都需要靠銀行才能完成交易
- 風險集中：遭受天災、搶劫...因為帳本只有一個，壞了就都沒了

### 舉例:村莊
區塊鏈的方法
- 每個人手上都有一本帳本

交易發生時
- 交易雙方各自在自己的帳本上紀錄此事件
- 告訴鄰居、其他人這筆交易的發生
    - 最後所有人都會知道這筆交易的發生
    
區塊鏈帳本無法抄到無限長，如何分塊？
- 區塊
    - 每一天結束就將當天交易內容總結撕塊
    - 複製很多份交給其他人(所以我也會收到其他人的區塊，代表每個人對於當天交易內容的認知)
- 鏈
    - 我會收到很多人的區塊，並確認交易的內容是否有衝突(**雙重花費的問題**)
        - 我拿50元給Ａ要買東西，Ａ說ＯＫ。我又拿這50元去跟Ｂ說要買東西
    - 會有很多條區塊鏈，在檢查過程中刪掉錯誤的鏈，如此慢慢收斂
        - 最後每個人的區塊鏈都會是相同的
        - 每個人都會基於最正確的區塊鏈去擴張其他的區塊(**最長鏈原則**)
    - 如果Ａ上有一些其他人都沒有的交易資訊，但Ａ產生的區塊被刪掉了
        - 不過Ａ曾經傳過這個紀錄給其他人了，其他人就會把這個資料繼續擴展下去
        - 最終這筆交易還是會被加入在區塊鏈中
            - 延遲性很高 
            - 交易手續費的問題：“如果你能幫我把這筆交易放到區塊鏈上，就給你多少的手續費”

達到最長鏈的方法
1. 沒有交易衝突
2. 發出區塊的速度比其他人快

### 區塊＋鏈
- 不能竄改性
    - 如果要竄改，要叫所有人都幫你改，Cost非常的高
- 公開性
    - 所有人都會有最長的那條鏈

### 兩種角色
#### 礦工
- 紀錄交易
- 製造區塊
- 宣傳新的交易與區塊給鄰居
- 獎勵：每成功發布一個區塊到最長鏈上，就會得到該區塊的獎勵
    - 因為越多人加入，該幣值的稀缺性就會越高，所以開發者透過此方式不斷注入新的資金，直到有一天該幣值達到飽和
    - 每筆塊內的交易都能抽手續費

#### 普通村民
- 宣傳新的交易與區塊給鄰居
    - 因為區塊鏈需要有人幫忙進行散播
- 能自由進行交易
- 獎勵：不會被踢出村子

### 礦工競爭
#### 獎勵派發
- 礦獎勵：一個新的轉帳收據
- 自己有多少錢？
    - 進來的錢-出去的錢=自己擁有的錢
這樣只透過紀錄檢查速度很慢，怎麼解決？
- 區塊鏈的想法：越久以前的資料越不可能被偽造
- 類似snapshot的方法，每隔一段時間計算你的錢總共有多少，之後的紀錄就基於這個總和繼續去繼續計算轉帳的紀錄。
    - 如果你的總和是錯的，發到其他人那邊還是不會過檢查

Q:獎勵金從哪裡來？
- 程式設計師一開始就會寫好規則，使得稀缺性維持在一個水平（震盪不會那麼大）

Q:一開始沒有交易，那第一個區塊哪裡來？
- 紀錄一些區塊鏈性質(發行貨幣總量)的區塊

#### 如何封箱(GEEK)
hash function特性
- 固定長度
- 相同的東西會有相同的結果，但只要有些微差異，答案就會不一樣
    - hash collision?
        - 機率很低，ex:為什麼地球上沒有兩個一模一樣的人？
- 無法回推
    - 唯一的方法：暴力法
    - 難度依靠在產生的長度
        - 256格：16(123...~abc...f)^256

區塊鏈以前是用投票決定最長鏈，但有個問題：**女巫攻擊**
- 所有人都是我的分身，誰是最長鏈我說了算
- 解決方法：增加難度->挖礦
    - 試出一組密碼，使得每個block有20個0在開頭
    - 16 * 16 * 16 * ....20次 = X
    - X / 電腦一秒計算次數 = 算出一個區塊所需時間

### 區塊鏈網路名詞介紹
- 網路
- 節點
- 共識算法
- 挖礦

### Demo
#### Blockchain Demo
https://anders.com/blockchain/blockchain.html

- 如果Data資料有被修改，hash前四個就不會是0000
- 礦工要不斷的修改Nonce，直到得到hash前四個bits是0的Nonce

資料是如何儲存的？
- 如果每次都將前面的區塊放進來，會越來越大
- 摘要的概念：hash value，只儲存前一個區塊的摘要
    - 所以不能竄改，因為hash值就會對不起來
    - 除非你從最前面的block竄改，然後發區塊的速度比其他人都還要快

第二個區塊會將第一個區塊作為資訊(Prev)，一起進行hash

#### 以太坊在用的區塊鏈瀏覽器
https://etherscan.io/
- Txn: transition的縮寫，多少筆交易
- Block Reward：
    - 挖到的時候會得到多少手續費
    - 礦工選擇工作的方式通常就是根據你要給他們多少手續費
    - 這手續費通常都是相同的，如果低於這個就很少有人會幫你挖

- Nonce:為了讓發區塊變得非常困難
    - 不能讓你一直發區塊
    - 只要量子電腦出來，以太坊區塊鏈就沒了
        - 量子電腦可以用開超快的速度去超過別人（ex:開根號）
        - 對抗方法
            - 讓系統安全性不依賴在挖礦速度上，ex:1秒就可以產生區塊
            - 量子電腦開根號也是1秒，所以在速度上不會差異太大
    - 如何提高挖礦難度
        - ex:找到一個Nonce使得前面4個零變5個零 


- Parent Hash：上一個區塊的交易摘要
- Block Height: 區塊鏈長度，該區塊後面還有幾個區塊

Q: 為什麼以太坊每個區塊的transition數量不同？以太坊有智能合約、程式長度有大有小
- 比特幣每個區塊的交易數量都會差不多，因為都是轉帳資訊
